POST kbn:/api/alerting/rule
{
  "params": {
    "searchType": "esqlQuery",
    "timeWindowSize": 5,
    "timeWindowUnit": "m",
    "threshold": [
      0
    ],
    "thresholdComparator": ">",
    "size": 100,
    "esqlQuery": {
      "esql": "FROM metrics-* | WHERE metrics.k8s.node.memory.available > 0 | EVAL MEMORY_UTILISATION = CASE(metrics.k8s.node.memory.usage/metrics.k8s.node.memory.available :: DOUBLE >= 0.8, \"true\",\"false\") | LIMIT 10 | keep resource.attributes.k8s.node.name, MEMORY_UTILISATION"
    },
    "aggType": "count",
    "groupBy": "all",
    "termSize": 5,
    "sourceFields": [],
    "timeField": "@timestamp"
  },
  "consumer": "infrastructure",
  "schedule": {
    "interval": "5m"
  },
  "tags": [
    "Metrics",
    "OTEL",
    "Node",
    "Memory"
  ],
  "name": "Node Memory Utilisation",
  "rule_type_id": ".es-query",
  "actions": []
}