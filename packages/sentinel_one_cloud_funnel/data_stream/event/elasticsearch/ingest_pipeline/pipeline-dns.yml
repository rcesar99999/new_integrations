---
description: Pipeline for processing DNS Event logs.
processors:
  - set:
      field: event.category
      value: [network]
  - set:
      field: event.type
      value: [info]
  - rename:
      field: json.event.dns.request
      target_field: sentinel_one_cloud_funnel.event.dns.request
      ignore_missing: true
  - rename:
      field: json.event.dns.response
      target_field: sentinel_one_cloud_funnel.event.dns.response
      ignore_missing: true
  - set:
      field: process.entity_id
      copy_from: sentinel_one_cloud_funnel.event.src.process.uid
      ignore_empty_value: true
  - set:
      field: process.parent.entity_id
      copy_from: sentinel_one_cloud_funnel.event.src.process.parent.uid
      ignore_empty_value: true
  - set:
      field: process.name
      copy_from: sentinel_one_cloud_funnel.event.src.process.name
      ignore_empty_value: true
      ignore_failure: true
on_failure:
  - append:
      field: error.message
      value: '{{{_ingest.on_failure_message}}}'
  - set:
      field: event.kind
      value: pipeline_error
